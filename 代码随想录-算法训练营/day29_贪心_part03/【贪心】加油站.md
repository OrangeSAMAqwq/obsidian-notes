# 题目：加油站 (Gas Station) ⛽🚗

## 题目链接  
https://leetcode.cn/problems/gas-station/

---

## 🧠 解题思路

### 📋 题意理解  
有一条环形公路，上面有 `n` 个加油站：

- `gas[i]`：第 `i` 个加油站能加的油量  
- `cost[i]`：从第 `i` 个加油站开到下一个站需要的油量  

要求找到一个起点，从该加油站出发，能够绕环一周并回到起点。  
如果不存在这样的起点，返回 `-1`。

---

## 🌟 核心思想：贪心（区间和思想）

这道题有两个非常关键的结论：

### ✅ 结论一：全局可行性判断  
如果所有站点的 **总油量 < 总消耗量**，那么一定无解。

数学表达为：

```text
Σ(gas[i] - cost[i]) < 0 → 无解
```

---

### ✅ 结论二：局部失败点之后才可能成功  
如果从某个起点出发，在中途油量变成负数：

- 那么 **从这个起点到失败点之间的任意一个位置作为起点，都是不可能成功的**
- 下一次可能的起点，一定在失败点的后面

这正是贪心的核心。

---

## ✨ 你的做法拆解

### 1️⃣ 预处理：转化问题

你直接把问题转化为：

```cpp
gas[i] -= cost[i];
```

此时：

- `gas[i]` 表示在第 `i` 个站的**净收益**
- 问题变成：是否存在一个起点，使得沿环走一圈时前缀和始终不为负

同时用 `flag` 统计总和：

```cpp
flag += gas[i];
```

如果 `flag < 0`，直接返回 `-1`。

---

### 2️⃣ 贪心扫描找起点

关键变量：

| 变量 | 含义 |
|----|----|
| `cnt` | 从当前候选起点出发的累计油量 |
| `index` | 当前候选起点 |

遍历过程中：

- 如果 `cnt < 0`，说明当前起点失败
- 那么下一次：
  - 把起点更新为当前位置 `i`
  - 重新开始累计油量

你的代码逻辑是：

```cpp
if (cnt < 0 && gas[i] > 0){
    index = i;
    cnt = gas[i];
}
else {
    cnt += gas[i];
}
```

本质就是在做「失败就换起点」的贪心策略。

---

## 💻 代码实现

```cpp
class Solution {
public:
    int canCompleteCircuit(vector<int>& gas, vector<int>& cost) {
        int flag = 0;
        for (int i = 0; i < gas.size(); i++){
            gas[i] -= cost[i];
            flag += gas[i];
        }
        if (flag < 0)
            return -1;

        int cnt = gas[0], index = 0;
        for (int i = 1; i < gas.size(); i++){
            if (cnt < 0 && gas[i] > 0){
                index = i;
                cnt = gas[i];
            }
            else {
                cnt += gas[i];
            }
        }
        return index;
    }
};
```

---

## 🔍 关键点解析

- **为什么总和判断一定要先做？**  
  因为局部贪心只有在“整体可行”的前提下才有意义。

- **为什么失败区间可以整体跳过？**  
  因为从失败起点到失败位置之间：
  - 油量前缀和已经为负
  - 换成其中任意一个点作为起点，只会更早失败

- **这是区间贪心的典型模型**
  - 和「最大子数组」「Jump Game」是同一类思想

---

## ⏱️ 复杂度分析

设 `n = gas.size()`：

| 类型 | 复杂度 |
|------|--------|
| 时间复杂度 | O(n) |
| 空间复杂度 | O(1) |

---

## 🧾 总结

- 本题是 **贪心算法的高频经典题**
- 两个关键点缺一不可：
  1. 总和判断（是否存在解）
  2. 局部失败就整体放弃（贪心换起点）
- 你的解法：
  - 思路清楚
  - 实现高效
  - 非常适合写进「贪心 · 环形区间问题」专题 👍

```text
加油站问题的精髓：
整体不亏才有解，局部亏损直接换起点
```

这道题的理解深度，已经明显超过“背题解”阶段了 ⭐
