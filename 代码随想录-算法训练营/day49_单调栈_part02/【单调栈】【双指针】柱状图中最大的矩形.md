# é¢˜ç›®ï¼šæŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢ï¼ˆLargest Rectangle in Histogramï¼‰ğŸ—ï¸ğŸ“ŠğŸ“ˆ

---

## ğŸ§  é¢˜ç›®ç†è§£

ç»™å®šä¸€ä¸ªéè´Ÿæ•´æ•°æ•°ç»„ `heights`ï¼Œæ¯ä¸ªå…ƒç´ è¡¨ç¤ºä¸€æ ¹å®½åº¦ä¸º `1` çš„æŸ±å­çš„é«˜åº¦ã€‚

ç›®æ ‡ï¼šæ‰¾å‡ºè¿™äº›æŸ±å­ä¸­èƒ½æ„æˆçš„**æœ€å¤§çŸ©å½¢é¢ç§¯**ã€‚

> åªèƒ½é€‰æ‹©**è¿ç»­çš„æŸ±å­**æ„æˆé•¿æ–¹å½¢ï¼Œé«˜åº¦å–å†³äºæœ€çŸ®çš„æŸ±å­ã€‚

---

## ğŸ” é—®é¢˜å»ºæ¨¡ï¼šå•è°ƒæ ˆ / å·¦å³è¾¹ç•Œæ³•ï¼ˆäºŒç»´è§£ç©ºé—´å‹ç¼©ï¼‰

æˆ‘ä»¬éœ€è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼š

> å¯¹äºæ¯ä¸ªæŸ±å­ `i`ï¼Œå‘å·¦å’Œå‘å³èƒ½å»¶ä¼¸å¤šè¿œï¼Œä¿è¯å»¶ä¼¸åŒºåŸŸæ‰€æœ‰æŸ±å­é«˜åº¦ â‰¥ `heights[i]`ã€‚

æœ¬è´¨ä¸Šæ˜¯æ±‚æ¯ä¸ªæŸ±å­ä½œä¸ºâ€œæœ€çŸ®æŸ±å­â€æ—¶ï¼Œæœ€å¤§çŸ©å½¢é¢ç§¯ã€‚

---

## âœ¨ æ–¹æ³•ä¸€ï¼šå•è°ƒæ ˆï¼ˆç»“æ„é©±åŠ¨ï¼‰

### ğŸ“ æ ˆä¸­å­˜æ”¾ä¸‹æ ‡ï¼Œç»´æŠ¤**é€’å¢é«˜åº¦åºåˆ—**

ä»å·¦å‘å³æ‰«ææ—¶ï¼š

- å¦‚æœå½“å‰æŸ±å­æ¯”æ ˆé¡¶é«˜ â†’ å…¥æ ˆ
- å¦‚æœå½“å‰æŸ±å­æ¯”æ ˆé¡¶çŸ® â†’ è§¦å‘â€œå‡ºæ ˆâ€æ“ä½œï¼Œå¤„ç†ä»¥æ ˆé¡¶æŸ±å­ä¸ºæœ€çŸ®çš„çŸ©å½¢

æ¯æ¬¡å‡ºæ ˆæ—¶ï¼š

- **é«˜åº¦** = `heights[st.top()]`
- **å®½åº¦** = `å½“å‰ç´¢å¼• i - æ ˆä¸­æ¬¡é¡¶å…ƒç´  - 1`

---

## ğŸ’» æ–¹æ³•ä¸€ä»£ç ï¼ˆä½ çš„ç‰ˆæœ¬ï¼‰

```c++
class Solution {
public:
    int largestRectangleArea(vector<int>& heights) {
        vector<int> st;
        int ans = heights[0];
        st.push_back(0);
        for (int i = 1; i < heights.size(); i++){
            while (!st.empty() && heights[i] < heights[st.back()]){
                int l = -1, r = i - 1;
                if (st.size() >= 2){
                    l = st[st.size() - 2];
                }
                int h = heights[st.back()];
                int cnt = h * (r - l);
                ans = max(ans, cnt);
                st.pop_back();
            }
            st.push_back(i);
        }

        for (int i = 0; i < st.size(); i++){
            int h = heights[st[i]];
            int l = -1, r = st.back();
            if (i > 0)
                l = st[i - 1];
            ans = max(ans, (r - l) * h);
        }
        return ans;
    }
};
```

---

## âœ¨ æ–¹æ³•äºŒï¼šé¢„å¤„ç†å·¦å³è¾¹ç•Œï¼ˆTwo-Passï¼‰

### ğŸ“ æ€è·¯

å¯¹äºæ¯ä¸ªä½ç½® `i`ï¼š

- `left[i]`ï¼šå¾€å·¦æœ€è¿œèƒ½æ‰©å±•åˆ°å“ªä¸ªä½ç½®ï¼ˆç¬¬ä¸€ä¸ªå°äº `heights[i]` çš„å·¦è¾¹ç•Œï¼‰
- `right[i]`ï¼šå¾€å³æœ€è¿œèƒ½æ‰©å±•åˆ°å“ªä¸ªä½ç½®ï¼ˆç¬¬ä¸€ä¸ªå°äº `heights[i]` çš„å³è¾¹ç•Œï¼‰

è¿™æ ·æœ€å¤§å®½åº¦ä¸ºï¼š

```text
width = right[i] - left[i] - 1
```

é¢ç§¯ä¸ºï¼š

```text
area = width * heights[i]
```

---

## ğŸ’» æ–¹æ³•äºŒä»£ç ï¼ˆä½ çš„ç‰ˆæœ¬ï¼‰

```c++
class Solution {
public:
    int largestRectangleArea(vector<int>& heights) {
        std::vector<int> right(heights.size());
        std::vector<int> left(heights.size());
        int maxVal = 0;
        std::stack<int> s;
        // ä»å·¦å¾€å³æ‰¾å³è¾¹ç¬¬ä¸€ä¸ªæ›´å°å…ƒç´ 
        for (int i = 0; i < right.size(); i++){
            while(!s.empty() && heights[i] < heights[s.top()]){
                right[s.top()] = i;
                s.pop();
            }
            s.push(i);
        }
        while(!s.empty()){
            right[s.top()] = right.size();
            s.pop();
        }
        // ä»å³å¾€å·¦æ‰¾å·¦è¾¹ç¬¬ä¸€ä¸ªæ›´å°å…ƒç´ 
        for (int i = left.size() - 1; i >= 0; i--){
            while(!s.empty() && heights[i] < heights[s.top()]){
                left[s.top()] = i;
                s.pop();
            }
            s.push(i);
        }
        while(!s.empty()){
            left[s.top()] = -1;
            s.pop();
        }

        for (int i = 0; i < heights.size(); i++){
            int width = right[i] - left[i] - 1;
            int cnt = heights[i] * width;
            maxVal = max(maxVal, cnt);
        }

        return maxVal;
    }
};
```

---

## â±ï¸ å¤æ‚åº¦åˆ†æ

ä¸¤ç§æ–¹æ³•æ—¶é—´/ç©ºé—´å¤æ‚åº¦ç›¸åŒï¼š

- **æ—¶é—´å¤æ‚åº¦**ï¼šO(n)
- **ç©ºé—´å¤æ‚åº¦**ï¼šO(n)

---

## ğŸ§¾ æ ¸å¿ƒè®°å¿†ç‚¹ï¼ˆéå¸¸é‡è¦ï¼‰

### âœ… æ–¹æ³•ä¸€ï¼šå•è°ƒæ ˆç‰ˆ

```text
æ ˆä¸­ç»´æŠ¤é€’å¢é«˜åº¦
é‡åˆ°æ›´çŸ®æŸ±å­ â†’ å¼¹æ ˆå¹¶ç»“ç®—çŸ©å½¢
æ¯ä¸ªæŸ±å­å…¥æ ˆå‡ºæ ˆä¸€æ¬¡
```

### âœ… æ–¹æ³•äºŒï¼šè¾¹ç•Œæ•°ç»„æ³•

```text
left[i]ï¼šå·¦è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„ä½ç½®
right[i]ï¼šå³è¾¹ç¬¬ä¸€ä¸ªæ¯”å®ƒå°çš„ä½ç½®
é¢ç§¯ = heights[i] Ã— (right[i] - left[i] - 1)
```

ä¸€å¥è¯æ€»ç»“ï¼š

> **æ¯ä¸ªæŸ±å­ä½œä¸ºæœ€çŸ®æŸ±å­æ—¶èƒ½æ‰©å±•çš„æœ€å¤§å®½åº¦ Ã— é«˜åº¦ = æœ€å¤§é¢ç§¯å€™é€‰**

---

## ğŸ”— æ€ç»´è¿ç§»

æœ¬é¢˜æ˜¯â€œå•è°ƒæ ˆâ€çš„é»„é‡‘æ¨¡æ¿é¢˜ï¼Œå¼ºçƒˆå»ºè®®ç‰¢ç‰¢æŒæ¡ã€‚ä¸ä»¥ä¸‹é—®é¢˜é«˜åº¦ç›¸å…³ï¼š

- æ¥é›¨æ°´ï¼ˆTrapping Rain Waterï¼‰
- åŒ…å«æœ€å°å€¼çš„æœ€å¤§ä¹˜ç§¯
- æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„å·¦/å³è¾¹ç¬¬ä¸€ä¸ªæ›´å°å…ƒç´ 

å°¤å…¶é€‚åˆæ”¶å½•è¿›ä½ æ„å»ºçš„ã€å•è°ƒç»“æ„ & åŒºé—´æœ€å€¼ã€‘ä¸“é¢˜ç¬”è®° âœ…
