# é¢˜ç›®ï¼šé€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼ (Evaluate Reverse Polish Notation) ğŸ§®ğŸ“˜

## é¢˜ç›®é“¾æ¥ ğŸŒ  
https://leetcode.cn/problems/evaluate-reverse-polish-notation/

---

## è§£é¢˜æ€è·¯ ğŸ§ 

### é¢˜æ„ç†è§£ ğŸ“‹

ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ `tokens`ï¼Œè¡¨ç¤ºä¸€ä¸ªåˆæ³•çš„**é€†æ³¢å…°è¡¨è¾¾å¼ï¼ˆRPNï¼‰**ï¼Œè¯·ä½ è®¡ç®—è¡¨è¾¾å¼çš„å€¼å¹¶è¿”å›ç»“æœã€‚

é€†æ³¢å…°è¡¨è¾¾å¼ï¼ˆåç¼€è¡¨è¾¾å¼ï¼‰ç‰¹ç‚¹ï¼š

- æ“ä½œç¬¦åœ¨æ“ä½œæ•°åå‡ºç°ï¼Œå¦‚ï¼š`["2", "1", "+", "3", "*"]` ç­‰ä»·äº `(2 + 1) * 3`
- æ— éœ€æ‹¬å·ï¼Œå¤©ç„¶ç¬¦åˆè®¡ç®—é¡ºåº

---

### è§£æ³•æ€è·¯ï¼šæ ˆç»“æ„æ¨¡æ‹Ÿè¡¨è¾¾å¼è¿ç®— ğŸ“š

æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ ˆ `ans` æ¥å­˜å‚¨ä¸­é—´è®¡ç®—ç»“æœï¼š

1. éå†æ¯ä¸ª tokenï¼š
   - è‹¥æ˜¯æ•°å­—ï¼ˆåŒ…æ‹¬è´Ÿå·å¼€å¤´çš„æ•°å­—ï¼‰ï¼Œè½¬æ¢ä¸ºæ•´æ•°ï¼Œå‹å…¥æ ˆï¼›
   - è‹¥æ˜¯æ“ä½œç¬¦ï¼ˆå¦‚ `+ - * /`ï¼‰ï¼š
     - å¼¹å‡ºæ ˆé¡¶ä¸¤ä¸ªæ•° `a`, `b`ï¼›
     - è®¡ç®— `b op a`ï¼›
     - å°†ç»“æœå‹å…¥æ ˆã€‚

2. éå†å®Œæˆåï¼Œæ ˆé¡¶å…ƒç´ å³ä¸ºè¡¨è¾¾å¼çš„æœ€ç»ˆå€¼ã€‚

---

### æœ¬ä»£ç çš„å…·ä½“å®ç° ğŸ’¡

#### è¾…åŠ©å‡½æ•°ä¸€ï¼š`stringToNum`  

å°†å­—ç¬¦ä¸²æ‰‹åŠ¨è½¬æ¢ä¸ºæ•´æ•°ï¼Œæ”¯æŒè´Ÿå·å¤„ç†ã€‚

```cpp
int stringToNum(const string &s) {
    int ans = 0;
    for (int i = 0; i < s.size(); i++) {
        if (i == 0 && s[0] == '-') continue;
        ans *= 10;
        ans += s[i] - '0';
    }
    if (s[0] == '-') ans *= -1;
    return ans;
}
```

#### è¾…åŠ©å‡½æ•°äºŒï¼š`ansCal`  

ä»æ ˆä¸­å¼¹å‡ºä¸€ä¸ªæ•° `cnt`ï¼Œå¯¹å‰ä¸€ä¸ªæ ˆé¡¶å…ƒç´ æ‰§è¡Œæ“ä½œã€‚

```cpp
void ansCal(vector<int> &ans, const string &s) {
    int cnt = ans.back(); ans.pop_back();
    int n = ans.size();
    if (s[0] == '+') ans[n - 1] += cnt;
    else if (s[0] == '-') ans[n - 1] -= cnt;
    else if (s[0] == '*') ans[n - 1] *= cnt;
    else if (s[0] == '/') ans[n - 1] /= cnt;
}
```

---

## å®Œæ•´ä»£ç å®ç° ğŸ’»

```cpp
class Solution {
public:
    int stringToNum(const string &s){
        int ans = 0;
        for (int i = 0; i < s.size(); i++){
            if (i == 0 && s[0] == '-') continue;
            ans *= 10;
            ans += s[i] - '0';
        }
        if (s[0] == '-') ans *= -1;
        return ans;
    }

    void ansCal(vector<int> &ans, const string &s){
        int cnt = ans.back();
        ans.pop_back();
        int n = ans.size();
        if (s[0] == '+') ans[n - 1] += cnt;
        else if (s[0] == '-') ans[n - 1] -= cnt;
        else if (s[0] == '*') ans[n - 1] *= cnt;
        else if (s[0] == '/') ans[n - 1] /= cnt;
    }

    int evalRPN(vector<string>& tokens) {
        vector<int> ans;
        for (int i = 0; i < tokens.size(); i++) {
            if (isdigit(tokens[i].back())) {
                ans.push_back(stringToNum(tokens[i]));
            } else {
                ansCal(ans, tokens[i]);
            }
        }
        return ans.back();
    }
};
```

---

## è¾¹ç•Œæƒ…å†µ ğŸš¨

1. è¡¨è¾¾å¼åªå«ä¸€ä¸ªæ•°å­—ï¼šå¦‚ `["42"]`ï¼Œè¿”å› `42`
2. è¡¨è¾¾å¼å«è´Ÿæ•°ï¼šå¦‚ `["4", "-2", "/"]`ï¼Œåº”è¿”å› `-2`
3. é™¤æ³•ç»“æœä¸ºè´Ÿæ•°æ—¶ï¼šéµå¾ª C++ æ•´æ•°é™¤æ³•è§„åˆ™ï¼ˆå‘ 0 å–æ•´ï¼‰

---

## å¤æ‚åº¦åˆ†æ â±ï¸

- æ—¶é—´å¤æ‚åº¦ï¼š**O(n)**ï¼Œæ¯ä¸ª token åªå¤„ç†ä¸€æ¬¡ï¼›
- ç©ºé—´å¤æ‚åº¦ï¼š**O(n)**ï¼Œç”¨äºæ ˆå­˜å‚¨ä¸­é—´ç»“æœã€‚

---

## æ€»ç»“ ğŸ“š

- æœ¬é¢˜æ˜¯**è¡¨è¾¾å¼æ±‚å€¼ç±»é¢˜ç›®**ä¸­ç»å…¸çš„ä¸€ç§ï¼Œè€ƒå¯Ÿæ ˆç»“æ„åº”ç”¨ï¼›
- é‡ç‚¹æ˜¯ç†è§£é€†æ³¢å…°è¡¨è¾¾å¼çš„æ“ä½œé¡ºåºä¸**åç¼€è®¡ç®—è§„åˆ™**ï¼›
- è‡ªå®šä¹‰å‡½æ•° `stringToNum` ä¸ `ansCal` å°†é€»è¾‘æ‹†åˆ†æ¸…æ™°ï¼Œæ˜“äºè°ƒè¯•ä¸å¤ç”¨ âœ…
