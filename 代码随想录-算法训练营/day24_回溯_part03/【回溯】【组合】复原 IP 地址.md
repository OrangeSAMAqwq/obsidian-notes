# é¢˜ç›®ï¼šå¤åŸ IP åœ°å€ (Restore IP Addresses) ğŸŒğŸ”§

## é¢˜ç›®é“¾æ¥  
https://leetcode.cn/problems/restore-ip-addresses/

---

## ğŸ§  è§£é¢˜æ€è·¯

### ğŸ“‹ é¢˜æ„ç†è§£  
ç»™å®šä¸€ä¸ªåªåŒ…å«æ•°å­—çš„å­—ç¬¦ä¸² `s`ï¼Œéœ€è¦æŠŠå®ƒæ‹†æˆ 4 æ®µï¼Œç»„æˆåˆæ³•çš„ IPv4 åœ°å€ï¼š

- å½¢å¼ï¼š`a.b.c.d`
- æ¯æ®µæ»¡è¶³ï¼š
  - é•¿åº¦ 1 ~ 3
  - æ•°å€¼ 0 ~ 255
  - ä¸èƒ½æœ‰å‰å¯¼ 0ï¼ˆé™¤éè¯¥æ®µå°±æ˜¯ `"0"`ï¼‰

è¿”å›æ‰€æœ‰å¯èƒ½çš„åˆæ³• IPã€‚

---

## ğŸŒŸ æ ¸å¿ƒæ€æƒ³ï¼šå›æº¯ï¼ˆBacktrackingï¼‰+ å¼ºå‰ªæ

è¿™é¢˜å±äºâ€œåˆ‡å‰²å‹å›æº¯â€ï¼š

- æ¯ä¸€æ®µå°±æ˜¯ä¸€æ¬¡åˆ‡å‰²
- ä» `start` å¼€å§‹ï¼Œæœ€å¤šåˆ‡ 1~3 ä½ä½œä¸ºä¸€ä¸ªæ®µ
- æ®µåˆæ³•åˆ™ç»§ç»­åˆ‡ä¸‹ä¸€æ®µ
- åˆ‡æ»¡ 4 æ®µä¸”åˆšå¥½ç”¨å®Œå­—ç¬¦ => è®°å½•ç­”æ¡ˆ

---

## âœ‚ï¸ å…³é”®å‰ªæï¼ˆå«é‡‘é‡å¾ˆé«˜ï¼‰

ä½ åœ¨é€’å½’ä¸€å¼€å§‹åšäº†é•¿åº¦å‰ªæï¼š

```cpp
if (s.size() - start < count || s.size() - start > count * 3)
    return;
```

å«ä¹‰ï¼š

- å‰©ä½™å­—ç¬¦æ•° `rest = s.size() - start`
- å‰©ä½™æ®µæ•° `count`
- æ¯æ®µè‡³å°‘ 1 ä½ã€æœ€å¤š 3 ä½

å› æ­¤å¿…é¡»æ»¡è¶³ï¼š

- `rest >= count`
- `rest <= 3 * count`

å¦åˆ™æ— è®ºæ€ä¹ˆåˆ‡éƒ½ä¸å¯èƒ½åˆæ³•ï¼Œç›´æ¥å‰ªæ‰æ•´æ£µåˆ†æ”¯ âœ…

---

## âœ… æ¯æ®µåˆæ³•æ€§åˆ¤æ–­

æ¯æ¬¡æšä¸¾ `i` æ—¶æˆªå–ï¼š

```cpp
str = s[start .. i]
```

ç„¶åæ£€æŸ¥ï¼š

1) å‰å¯¼ 0ï¼š

```cpp
if (str.size() > 1 && str[0] == '0') break;
```

ä¸€æ—¦å‡ºç°å‰å¯¼ 0ï¼Œç»§ç»­æ‰©å±•é•¿åº¦åªä¼šæ›´ä¸åˆæ³•ï¼Œæ‰€ä»¥ç›´æ¥ `break`ï¼ˆæ¯” continue æ›´å¼ºçš„å‰ªæï¼‰âœ…

2) æ•°å€¼èŒƒå›´ï¼š

```cpp
if (stoi(str) <= 255)
```

---

## ğŸ§© æ„é€ å­—ç¬¦ä¸²çš„æŠ€å·§ï¼ˆé¿å…é¢å¤–æ•°ç»„ï¼‰

ä½ ç”¨çš„æ˜¯å­—ç¬¦ä¸² `t` ç›´æ¥æ‹¼æ¥ï¼Œè€Œä¸æ˜¯ç”¨`vector<string> `å† joinï¼š

- è®°å½•æ‹¼æ¥å‰çš„é•¿åº¦ `index`
- é€’å½’åç”¨ `erase` å›é€€åˆ° index


```cpp
int index = t.size();
...
t += str;
dfs(...);
t.erase(t.begin() + index, t.end());
```



è¿™ç§å›æº¯æ–¹å¼éå¸¸å¹²å‡€åˆ©è½ âœ¨

---

## ğŸ’» ä»£ç å®ç°

```cpp
class Solution {
public:
    void dfs(auto &ans, auto &t, const string &s, int start, int count){
        if (s.size() - start < count || s.size() - start > count * 3)
            return;
        if (count == 0){
            ans.push_back(t);
            return;
        }
        for (int i = start; i < min((int)s.size(), start + 3); i++){
            string str = string(s.begin() + start, s.begin() + i + 1);
            if (str.size() > 1 && str[0] == '0')
                break;

            if (stoi(str) <= 255){
                int index = t.size();
                if (start != 0)
                    t += '.';
                
                t += str;
                dfs(ans, t, s, i + 1, count - 1);
                t.erase(t.begin() + index, t.end());
            }
        }
    }

    vector<string> restoreIpAddresses(string s) {
        vector<string> ans;
        if (s.size() < 4 || s.size() > 12)
            return ans;
        string t;
        dfs(ans, t, s, 0, 4);
        return ans;
    }
};
```

---

## ğŸ” å…³é”®ç‚¹æ€»ç»“

- `count` è¡¨ç¤ºè¿˜éœ€è¦åˆ‡å¤šå°‘æ®µï¼ˆä» 4 åˆ° 0ï¼‰
- æ¯æ¬¡æœ€å¤šåˆ‡ 3 ä½ï¼š`i < start + 3`
- å¼ºå‰ªæï¼šå‰©ä½™å­—ç¬¦å¿…é¡»è½åœ¨ `[count, 3*count]`
- å‰å¯¼ 0 å‰ªæç”¨ `break`ï¼ˆå› ä¸ºç»§ç»­å˜é•¿æ›´ä¸å¯èƒ½åˆæ³•ï¼‰
- ç”¨ `t` + `erase` å®ç°å­—ç¬¦ä¸²å›æº¯ï¼Œçœæ‰ join æ“ä½œ

---

## â±ï¸ å¤æ‚åº¦åˆ†æ

- ç”±äºæ¯æ®µæœ€å¤š 3 ç§åˆ‡æ³•ï¼Œæ€»åˆ†æ”¯ä¸Šç•Œæ¥è¿‘ `3^4 = 81`
- å®é™…è¿˜æœ‰é•¿åº¦å‰ªæä¸å‰å¯¼ 0 å‰ªæï¼Œæœç´¢è§„æ¨¡å¾ˆå°

| ç±»å‹ | å¤æ‚åº¦ |
|------|--------|
| æ—¶é—´å¤æ‚åº¦ | è¿‘ä¼¼ O(1)ï¼ˆæœ€å¤šæšä¸¾å¸¸æ•°çº§åˆ†æ”¯ï¼‰ |
| ç©ºé—´å¤æ‚åº¦ | O(1) ~ O(é€’å½’æ·±åº¦)ï¼ˆæ·±åº¦å›ºå®š 4ï¼‰ |

---

## ğŸ§¾ æ€»ç»“

è¿™é¢˜çš„æœ¬è´¨æ˜¯åˆ‡å‰²å‹å›æº¯ï¼Œä½†å†™å¾—æ¼‚äº®çš„å…³é”®åœ¨äºå‰ªæï¼š

- **é•¿åº¦å‰ªæ**ï¼ˆå‰©ä½™å­—ç¬¦æ•°èŒƒå›´ï¼‰éå¸¸æœ‰æ•ˆ
- **å‰å¯¼ 0 ç›´æ¥ break** ä¹Ÿå¾ˆèªæ˜
- å­—ç¬¦ä¸² `erase` å›æº¯æ–¹å¼ç®€æ´é«˜æ•ˆ

```text
åˆ‡å‰²å‹å›æº¯ä¸‰è¦ç´ ï¼š
startï¼ˆåˆ‡å‰²èµ·ç‚¹ï¼‰ + countï¼ˆå‰©ä½™æ®µæ•°ï¼‰ + åˆæ³•æ€§åˆ¤æ–­ï¼ˆèŒƒå›´/å‰å¯¼0ï¼‰
```
